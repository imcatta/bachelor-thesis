\chapter{Scelta dei parametri del protocollo}
\label{chap:dimensionamento}

In questo capitolo vedremo quali sono i parametri del protocollo
e analizzaremo alcuni criteri per il dimensionamento.

\section{I Parametri}

\subsection{La deadline $ \tau $}
La deadline $ \tau $ rappresenta l'istante di tempo in cui
si desidera che il segreto venga reso pubblico.
Si tratta di un parametro deciso a priori, sul quale difficilmente si riesce ad
intervenire. Ad ogni modo è bene sapere che più $ \tau $ è lontano, più aumentano
le possibilità che qualcosa vada storto. La ragione è che più è lontana la deadline,
più cresce la probabilità che i \textit{provider} smarriscano o vengano derubati
del segreto.

\subsection{La tolleranza $ \delta $}
La tolleranza $ \delta $ rappresenta quanto ritardo rispetto a $ \tau $ è
accettato per la pubblicazione del segreto. Una tolleranza troppo
piccola potrebbe causare problemi se il client non è abbastanza reattivo
al tempo $ \tau $, ad esempio
per un intasamento del network o
perché è
temporaneamente offline.
Allo stesso tempo una tolleranza
troppo grande potrebbe causare un ritardo non accettabile rispetto alla deadline.
Per la scelta di questo parametro è ben tenere in considerazione anche
la velocità di elaborazione delle transazioni
del DLT sottostante.

\subsection{Il \textit{prize}}
Il \textit{prize} è la ricompensa da corrispondere al provider per il suo servizio
di detenzione del segreto. È una cifra che deve essere concordata tra le parti,
ed è bene che sia proporzionale a quanto dista $ \tau $ dal momento
dell'inizializzazione del protocollo
e a quanto è importante il segreto.
$$ \textit{prize} \propto \tau - t_{init} $$

\subsection{Il \textit{counterprize}}
\label{subsec:counterprize}
Il \textit{counterprize} è la cifra che viene corrisposta a chi invia il segreto
allo smart contract prima del tempo $ \tau $. È bene che
\begin{center}
	\textit{prize} $ \gg $ \textit{counterprize}
\end{center}
Il motivo di questo vincolo è che il provider potrebbe in un qualsiasi istante
prima di $ \tau $ ottenere
il \textit{counterprize} (perché chiaramente conosce il segreto) e quindi
rendere noto il segreto prima della deadline. Se però il
\textit{prize} è molto più grande sarebbe contro il suo
interesse farlo,
poiché perderebbe la possibilità di ottenere un guadagno significativamente
maggiore al tempo $ \tau $.

\subsection{Il \textit{pawn}}
Il \textit{pawn} è la cifra che viene restituita al client quando il segreto
viene pubblicato nella finestra temporale $ \tau \leq t \leq \tau + \delta $.

Il \textit{pawn} è necessario perché, ovviamente, anche il client conosce il segreto
e quindi potrebbe ottenere il \textit{counterprize} (magari poco prima della deadline).
Se lo facesse il provider non potrebbe più ottenere il \textit{prize} anche se si è
comportato in maniera corretta, venendo in un certo senso truffato dal client.
Come nel caso del \hyperref[subsec:counterprize]{\textit{counterprize}}
si vuole scoraggiare questo comportamento con il vincolo
\begin{center}
	\textit{pawn} $ \gg $ \textit{counterprize}
\end{center}

\subsection{Numero di share}
Il numero di share $ n $ è uno dei parametri
dell'algoritmo di secret sharing, utilizzato dalla versione
avanzata del protocollo.
La scelta di questo valore determina automaticamente anche il numero di provider
necessari.
Facciamo notare che la versione base può essere vista come un caso particolare
della versione avanzata, dove $ n = 1 $.

\subsection{Threshold per la ricostruzione del segreto}
Il threshold $ t $ rappresenta il numero minimo di share che
sono necessari per la ricostruzione del segreto.
Anche in questo caso la versione base può essere vista come un caso particolare
della versione avanzata, dove $ t = 1 $.

\section{Criteri di dimensionamento}

\subsection{Denaro necessario}
Il denaro necessario $ d $ rappresenta quanto denaro è necessario per inizializzare
il protocollo.
$$ d = \sum_{i=1}^{N} \textit{prize}_i + pawn_i + fee_i $$
Nell'ipotesi che tutti i \textit{prize} e tutti i \textit{pawn}
siano uguali tra loro e che le commissioni \textit{fee} siano trascurabili
l'espressione diventa
$$ d = N(prize + pawn) $$
\textbf{N.B.} Questo valore non è il costo che deve sostenere il client, perché parte
di questi soldi gli verranno restituiti attraverso i \textit{pawn}.

\subsection{Costo}
Il costo $ c $ rappresenta quanto denaro dovrà spendere il client per il servizio
richiesto. Il costo non è fissato a priori,
perché dipende da quanti \textit{pawn} verranno
restituiti.
$$ c = \sum_{i=1}^{N} (\textit{prize}_i + \textit{fee}_i) + \sum \textit{pawn}_j $$
\begin{flushright}
	dove $ \sum \textit{pawn}_j $ è la somma dei \textit{pawn} restituiti.
\end{flushright}
Nel caso migliore, ossia quando tutti i \textit{pawn} ritornano al client diventa
$$ c = \sum_{i=1}^{N} (prize_i + fee_i) $$
Mentre nel caso peggiore, ossia quando nessun \textit{pawn}
ritorna al client, è pari a
$$ c = d = \sum_{i=1}^{N} (prize_i + pawn_i + fee_i) $$


\subsection{Resistenza a smarrimenti}
La resistenza agli smarrimenti $ \theta $ rappresenta 
il numero di provider che possono non
rendere noto il proprio share senza compromettere la pubblicazione del messaggio
originale.
$$ \theta = n - t $$
È interessante valutare questo valore in relazione
al numero totale di share $ n $.
$$ \theta_r = \frac{n - t}{n} $$
$$ \theta_\% = 100 \cdot \theta_r = 100 \cdot \frac{n - t}{n} $$

\subsection{Resistenza a furti}
\label{subsec:resistenza-a-furti}
La resistenza ai furti $ \gamma $ è il numero di share che un soggetto deve riuscire
ad ottenere dai provider affinchè possa
ricostruire il segreto prima del tempo $ \tau $.
Questo numero è ovviamente pari al threshold.
\begin{center}
	$ \gamma = t $
\end{center}








